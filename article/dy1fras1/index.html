<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="智能化应用（shell）1.1 创建主目录及各层级目录12345678# 创建主目录mkdir -p &#x2F;root&#x2F;smart-police-system&#x2F;# 创建基础层目录mkdir -p &#x2F;root&#x2F;smart-police-system&#x2F;Infrastructure_Layer&#x2F;Network_Configuration# 创建服务层目录mkdir -p &#x2F;root&#x2F;smart-police-">
<meta property="og:type" content="article">
<meta property="og:title" content="大数据模拟赛题解">
<meta property="og:url" content="https://youngking-gfy.github.io/article/dy1fras1/index.html">
<meta property="og:site_name" content="Youngking&#39;s Blog">
<meta property="og:description" content="智能化应用（shell）1.1 创建主目录及各层级目录12345678# 创建主目录mkdir -p &#x2F;root&#x2F;smart-police-system&#x2F;# 创建基础层目录mkdir -p &#x2F;root&#x2F;smart-police-system&#x2F;Infrastructure_Layer&#x2F;Network_Configuration# 创建服务层目录mkdir -p &#x2F;root&#x2F;smart-police-">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2025-05-15T17:41:28.041Z">
<meta property="article:modified_time" content="2025-05-17T07:58:58.331Z">
<meta property="article:author" content="Y0ungK1ng">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>大数据模拟赛题解</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/youngking-gfy">Projects</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        
        <li><a class="icon" aria-label="Next post" href="/2025/05/13/pangushi2025/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://youngking-gfy.github.io/article/dy1fras1/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://youngking-gfy.github.io/article/dy1fras1/&text=大数据模拟赛题解"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://youngking-gfy.github.io/article/dy1fras1/&is_video=false&description=大数据模拟赛题解"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=大数据模拟赛题解&body=Check out this article: https://youngking-gfy.github.io/article/dy1fras1/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://youngking-gfy.github.io/article/dy1fras1/&name=大数据模拟赛题解&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://youngking-gfy.github.io/article/dy1fras1/&t=大数据模拟赛题解"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%8C%96%E5%BA%94%E7%94%A8%EF%BC%88shell%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">智能化应用（shell）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%8F%8A%E5%90%84%E5%B1%82%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 创建主目录及各层级目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%B8%BA%E7%9B%AE%E5%BD%95%E6%B7%BB%E5%8A%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 为目录添加文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E9%AA%8C%E8%AF%81%E7%9B%AE%E5%BD%95%E5%92%8C%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 验证目录和文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BC%96%E5%86%99%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6write-log-sh%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%B0%86%E6%97%B6%E9%97%B4%E4%BF%A1%E6%81%AF%E5%86%99%E5%85%A5%E6%9C%8D%E5%8A%A1%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%EF%BC%88service-log%EF%BC%89%EF%BC%8C%E4%BF%9D%E5%AD%98%E8%B7%AF%E5%BE%84%E4%B8%BA-root-scripts-%E3%80%82"><span class="toc-number">1.4.</span> <span class="toc-text">2 编写脚本文件write_log.sh，用于将时间信息写入服务日志文件（service.log），保存路径为&#x2F;root&#x2F;scripts&#x2F;。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B0%86%E4%BB%BB%E5%8A%A11%E4%B8%AD%E5%88%9B%E5%BB%BA%E7%9A%84%E9%A1%B9%E7%9B%AEsmart-police-system%E8%BF%9C%E7%A8%8B%E5%A4%8D%E5%88%B6%E8%87%B3%E4%B8%BB%E6%9C%BAjupyter%E5%AF%B9%E5%BA%94%E7%9A%84-root%E7%9B%AE%E5%BD%95%E4%B8%8B%E3%80%82"><span class="toc-number">1.5.</span> <span class="toc-text">3 将任务1中创建的项目smart-police-system远程复制至主机jupyter对应的 &#x2F;root目录下。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%BA%E6%9B%B4%E5%A5%BD%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E7%8A%B6%E6%80%81%EF%BC%8C%E4%BD%BF%E7%94%A8cron%E6%9D%A5%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%A6%81%E6%B1%82%E6%AF%8F%E4%BA%94%E5%88%86%E9%92%9F%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1write-log-sh%E8%84%9A%E6%9C%AC%E3%80%82"><span class="toc-number">1.6.</span> <span class="toc-text">4. 为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write_log.sh脚本。</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">伪分布式集群搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.</span> <span class="toc-text">基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%E4%B8%BA-qingjiao"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. 修改主机名为 qingjiao</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9-root-task"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. 创建文件夹 &#x2F;root&#x2F;task</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6-root-task-student"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. 创建文件 &#x2F;root&#x2F;task&#x2F;student</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BF%AE%E6%94%B9-hosts-%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E4%B8%BB%E6%9C%BA%E5%90%8D%E6%98%A0%E5%B0%84"><span class="toc-number">2.1.4.</span> <span class="toc-text">4. 修改 hosts 文件添加主机名映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA%E4%B8%BA%E4%B8%8A%E6%B5%B7%E6%97%B6%E9%97%B4"><span class="toc-number">2.1.5.</span> <span class="toc-text">5. 修改时区为上海时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%B7%BB%E5%8A%A0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">2.1.6.</span> <span class="toc-text">6. 添加定时任务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH%E5%85%8D%E5%AF%86%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.</span> <span class="toc-text">SSH免密配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%8A%82%E7%82%B9%E4%B8%AD%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%E6%96%87%E4%BB%B6id-rsa-pub-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8DRSA%EF%BC%8C%E7%94%A8%E6%88%B7root%EF%BC%8C%E4%B8%BB%E6%9C%BA%E5%90%8Dqingjiao"><span class="toc-number">2.2.1.</span> <span class="toc-text">1. 节点中生成公钥文件id_rsa.pub(数字签名RSA，用户root，主机名qingjiao)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BB%BA%E2%BD%B4qingjiao%E2%BE%83%E8%BA%AB%E4%BD%BF%E2%BD%A4root%E2%BD%A4%E6%88%B7ssh%E8%AE%BF%E9%97%AElocalhost%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%EF%BC%88%E8%87%AA%E8%A1%8C%E5%AE%8C%E6%88%90%E9%A6%96%E6%AC%A1%E5%85%AC%E9%92%A5%E5%8C%99%E8%AE%A4%E8%AF%81%EF%BC%89"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. 建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.</span> <span class="toc-text">JDK安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86jdk%E5%AE%89%E8%A3%85%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%88%B0-usr-java%E7%9B%AE%E5%BD%95%EF%BC%88%E5%AE%89%E8%A3%85%E5%8C%85%E5%AD%98%E6%94%BE%E4%BA%8E-usr-package277%EF%BC%8C%E8%B7%AF%E5%BE%84%E8%87%AA%E8%A1%8C%E5%88%9B%E5%BB%BA%EF%BC%8C%E8%A7%A3%E5%8E%8B%E5%90%8E%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%BA%E9%BB%98%E8%AE%A4%E5%90%8D%E7%A7%B0%EF%BC%8C%E5%85%B6%E4%BB%96%E5%AE%89%E8%A3%85%E5%90%8C%E7%90%86%EF%BC%89"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.将jdk安装包解压到&#x2F;usr&#x2F;java目录（安装包存放于&#x2F;usr&#x2F;package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FJAVA-HOME%EF%BC%8C%E5%90%8C%E6%97%B6%E5%B0%86JDK%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%E4%B8%ADbin%E7%9B%AE%E5%BD%95%E5%8A%A0%E5%85%A5PATH%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%8C%E6%B3%A8%E6%84%8F%E7%94%9F%E6%95%88%E5%8F%98%E9%87%8F%EF%BC%8C%E6%9F%A5%E7%9C%8BJDK%E7%89%88%E6%9C%AC"><span class="toc-number">2.4.</span> <span class="toc-text">2. 配置系统环境变量JAVA_HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hadoo%E4%BC%AA%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2"><span class="toc-number">2.5.</span> <span class="toc-text">Hadoo伪集群部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86Hadoop%E5%AE%89%E8%A3%85%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%88%B0%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84-usr-hadoop%EF%BC%88%E5%AE%89%E8%A3%85%E5%8C%85%E5%AD%98%E6%94%BE%E4%BA%8E-usr-package277-%EF%BC%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">1. 将Hadoop安装包解压到指定路径&#x2F;usr&#x2F;hadoop（安装包存放于&#x2F;usr&#x2F;package277&#x2F;）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FHADOOP-HOME%EF%BC%8C%E5%B0%86Hadoop%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%E4%B8%ADbin%E7%9B%AE%E5%BD%95%E5%92%8Csbin%E7%9B%AE%E5%BD%95%E5%8A%A0%E5%85%A5PATH%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%8C%E6%B3%A8%E6%84%8F%E7%94%9F%E6%95%88%E5%8F%98%E9%87%8F"><span class="toc-number">2.5.2.</span> <span class="toc-text">2. 配置环境变量HADOOP_HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AEHadoop%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83JAVA-HOME-hadoop-env-sh"><span class="toc-number">2.5.3.</span> <span class="toc-text">3. 配置Hadoop运行环境JAVA_HOME(hadoop-env.sh)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9AHDFS%E4%B8%8ANameNode%E5%9C%B0%E5%9D%80%E4%B8%BAqingjiao-%E7%AB%AF%E5%8F%A3%E9%BB%98%E8%AE%A4%E4%B8%BA9000-core-site-xml"><span class="toc-number">2.5.4.</span> <span class="toc-text">4. 设置全局参数，指定HDFS上NameNode地址为qingjiao,端口默认为9000(core-site.xml)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9A%E4%B8%B4%E6%97%B6%E5%AD%98%E5%82%A8%E7%9B%AE%E5%BD%95%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-tmp-%E8%A6%81%E6%B1%82%E4%B8%BA%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%EF%BC%8C%E4%B8%8B%E5%90%8C"><span class="toc-number">2.5.5.</span> <span class="toc-text">5. 设置全局参数，指定临时存储目录为本地&#x2F;root&#x2F;hadoopData&#x2F;tmp(要求为绝对路径，下同)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9A%E5%A4%87%E4%BB%BD%E6%96%87%E6%9C%AC%E6%95%B0%E9%87%8F%E4%B8%BA1%EF%BC%88hdfs-site-xml%EF%BC%89"><span class="toc-number">2.5.6.</span> <span class="toc-text">6. 设置HDFS参数，指定备份文本数量为1（hdfs-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9ANN%E5%AD%98%E6%94%BE%E5%85%83%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%E8%B7%AF%E5%BE%84%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-name%EF%BC%9B%E6%8C%87%E5%AE%9ADN%E5%AD%98%E6%94%BE%E5%85%83%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%E8%B7%AF%E5%BE%84%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-data-%E8%A6%81%E6%B1%82%E4%B8%BA%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-number">2.5.7.</span> <span class="toc-text">7. 设置HDFS参数，指定NN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;name；指定DN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;data(要求为绝对路径)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E5%85%B3%E9%97%ADhadoop%E9%9B%86%E7%BE%A4%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C%EF%BC%88%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%EF%BC%89%EF%BC%8C%E5%85%81%E8%AE%B8%E5%85%B6%E4%BB%96%E7%94%A8%E6%88%B7%E8%BF%9E%E6%8E%A5%E9%9B%86%E7%BE%A4"><span class="toc-number">2.5.8.</span> <span class="toc-text">8. 设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%AE%BE%E7%BD%AEYARN%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83-JAVA-HOME%E5%8F%82%E6%95%B0-yarn-env-sh"><span class="toc-number">2.5.9.</span> <span class="toc-text">9. 设置YARN运行环境$JAVA_HOME参数(yarn-env.sh)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E8%AE%BE%E7%BD%AEYARN%E6%A0%B8%E5%BF%83%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9Amapreduce-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%BAmapreduce-shuffle%EF%BC%88yarn-site-xml%EF%BC%89"><span class="toc-number">2.5.10.</span> <span class="toc-text">10. 设置YARN核心参数，指定mapreduce 获取数据的方式为mapreduce_shuffle（yarn-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E8%AE%BE%E7%BD%AE%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9AMR%E8%BF%90%E8%A1%8C%E5%9C%A8yarn%E4%B8%8A%EF%BC%88mapred-site-xml%EF%BC%89"><span class="toc-number">2.5.11.</span> <span class="toc-text">11. 设置计算框架参数，指定MR运行在yarn上（mapred-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E8%AE%BE%E7%BD%AE%E8%8A%82%E7%82%B9%E6%96%87%E4%BB%B6slaves%EF%BC%8C%E8%A6%81%E6%B1%82qingjiao%E4%B8%BA%E5%AD%90%E8%8A%82%E7%82%B9"><span class="toc-number">2.5.12.</span> <span class="toc-text">12. 设置节点文件slaves，要求qingjiao为子节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-%E5%AF%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">2.5.13.</span> <span class="toc-text">13. 对文件系统进行格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-%E5%90%AF%E5%8A%A8Hadoop%E9%9B%86%E7%BE%A4%E6%9F%A5%E7%9C%8B%E5%90%84%E8%8A%82%E7%82%B9%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.5.14.</span> <span class="toc-text">14. 启动Hadoop集群查看各节点服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8"><span class="toc-number">2.5.15.</span> <span class="toc-text">15. 查看集群运行状态是否正常</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">交通事故数据分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B5%E4%BF%A1%E8%AF%88%E9%AA%97%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%EF%BC%88Python%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">电信诈骗数据分析（Python）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E8%AF%B4%E6%98%8E"><span class="toc-number">4.0.1.</span> <span class="toc-text">背景说明</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number"></span> <span class="toc-text">一、探索性分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B4%E4%BD%93%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90%EF%BC%8C%E8%A7%82%E5%AF%9F%E7%89%B9%E5%BE%81%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="toc-number"></span> <span class="toc-text">二、整体特征分析，观察特征之间的相关性</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%86%E7%BB%84%E8%81%9A%E5%90%88%E5%88%86%E6%9E%90"><span class="toc-number"></span> <span class="toc-text">三、分组聚合分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BB%BB%E5%8A%A1%E4%B8%80%EF%BC%9A%E5%88%86%E6%9E%90-distance-from-home%E4%B8%8Efraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">3.2 任务一：分析 distance_from_home与fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BB%BB%E5%8A%A1%E4%BA%8C%EF%BC%9A%E5%88%86%E6%9E%90-ratio-to-median-purchase-price%E4%B8%8E-fraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.</span> <span class="toc-text">3.2 任务二：分析 ratio_to_median_purchase_price与 fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E4%BB%BB%E5%8A%A1%E4%B8%89%EF%BC%9A%E5%88%86%E6%9E%90-repeat-retailer%E4%B8%8E-fraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">3.</span> <span class="toc-text">3.3 任务三：分析 repeat_retailer与 fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql"><span class="toc-number">4.</span> <span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BC%80%E5%90%AF-MySQL-%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.1.</span> <span class="toc-text">1. 开启 MySQL 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93-relation"><span class="toc-number">4.2.</span> <span class="toc-text">2. 创建数据库 relation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8-user-%E5%B9%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">4.3.</span> <span class="toc-text">3. 创建数据表 user 并导入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8-friend-%E5%B9%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">4.4.</span> <span class="toc-text">4. 创建数据表 friend 并导入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%88%86%E6%9E%90%E4%B8%8D%E5%90%8C%E7%94%A8%E6%88%B7%E7%9A%84%E5%A5%BD%E5%8F%8B%E6%95%B0%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table1"><span class="toc-number">4.5.</span> <span class="toc-text">5. 分析不同用户的好友数并存储为视图 table1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7%E2%80%9C%E7%B3%BB%E4%B9%90%E2%80%9D%E7%9A%84%E6%89%80%E6%9C%89%E6%9C%8B%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table2"><span class="toc-number">4.6.</span> <span class="toc-text">6. 查找用户“系乐”的所有朋友信息并存储为视图 table2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E7%9A%84%E6%89%80%E6%9C%89%E5%A5%BD%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table3"><span class="toc-number">4.7.</span> <span class="toc-text">7. 查询用户的所有好友信息并存储为视图 table3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%9F%A5%E8%AF%A2%E2%80%9C%E7%B3%BB%E4%B9%90%E2%80%9D%E5%92%8C%E2%80%9C%E5%A7%9A%E6%AC%A3%E7%84%B6%E2%80%9D%E7%9A%84%E5%85%B1%E5%90%8C%E5%A5%BD%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table4"><span class="toc-number">4.8.</span> <span class="toc-text">8. 查询“系乐”和“姚欣然”的共同好友信息并存储为视图 table4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E8%BF%9B%E8%A1%8C%E7%A4%BE%E4%BA%A4%E7%BD%91%E7%BB%9C%E6%8C%96%E6%8E%98%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table5"><span class="toc-number">4.9.</span> <span class="toc-text">9. 进行社交网络挖掘并存储为视图 table5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">数据库安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%90%AF%E5%8A%A8-MySQL-%E6%9C%8D%E5%8A%A1%E5%B9%B6%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E7%8A%B6%E6%80%81"><span class="toc-number">5.1.</span> <span class="toc-text">1. 启动 MySQL 服务并查看服务状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-qingjiao"><span class="toc-number">5.2.</span> <span class="toc-text">2. 创建用户 qingjiao</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8E%88%E4%BA%88-qingjiao-%E7%94%A8%E6%88%B7%E5%9C%A8-datatest-%E5%BA%93%E4%B8%8B%E7%9A%84-CREATE-%E6%9D%83%E9%99%90"><span class="toc-number">5.3.</span> <span class="toc-text">3. 授予 qingjiao 用户在 datatest 库下的 CREATE 权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%87%E6%8D%A2%E5%88%B0-qingjiao-%E7%94%A8%E6%88%B7%E5%B9%B6%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8"><span class="toc-number">5.4.</span> <span class="toc-text">4. 切换到 qingjiao 用户并创建数据库和表</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        大数据模拟赛题解
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Y0ungK1ng</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2025-05-15T17:41:28.041Z" class="dt-published" itemprop="datePublished">2025-05-16</time>
        
      
    </div>


      

      

    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="智能化应用（shell）"><a href="#智能化应用（shell）" class="headerlink" title="智能化应用（shell）"></a>智能化应用（shell）</h2><h3 id="1-1-创建主目录及各层级目录"><a href="#1-1-创建主目录及各层级目录" class="headerlink" title="1.1 创建主目录及各层级目录"></a>1.1 创建主目录及各层级目录</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建主目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /root/smart-police-system/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建基础层目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /root/smart-police-system/Infrastructure_Layer/Network_Configuration</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建服务层目录</span></span><br><span class="line"><span class="built_in">mkdir</span> -p /root/smart-police-system/Service_Layer/Logging_Service</span><br></pre></td></tr></table></figure>

<h3 id="1-2-为目录添加文件"><a href="#1-2-为目录添加文件" class="headerlink" title="1.2 为目录添加文件"></a>1.2 为目录添加文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在网络配置目录下创建 network.conf 配置文件</span></span><br><span class="line"><span class="built_in">touch</span> /root/smart-police-system/Infrastructure_Layer/Network_Configuration/network.conf</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在日志服务目录下创建 service.log 日志文件</span></span><br><span class="line"><span class="built_in">touch</span> /root/smart-police-system/Service_Layer/Logging_Service/service.log</span><br></pre></td></tr></table></figure>

<h3 id="1-3-验证目录和文件结构"><a href="#1-3-验证目录和文件结构" class="headerlink" title="1.3 验证目录和文件结构"></a>1.3 验证目录和文件结构</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tree</span><br></pre></td></tr></table></figure>


<h3 id="2-编写脚本文件write-log-sh，用于将时间信息写入服务日志文件（service-log），保存路径为-root-scripts-。"><a href="#2-编写脚本文件write-log-sh，用于将时间信息写入服务日志文件（service-log），保存路径为-root-scripts-。" class="headerlink" title="2 编写脚本文件write_log.sh，用于将时间信息写入服务日志文件（service.log），保存路径为/root/scripts/。"></a>2 编写脚本文件write_log.sh，用于将时间信息写入服务日志文件（<code>service.log</code>），保存路径为<code>/root/scripts/</code>。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 定义日志文件路径</span></span><br><span class="line">LOG_FILE=<span class="string">&quot;/root/smart-police-system/Service_Layer/Logging_Service/service.log&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前时间</span></span><br><span class="line">CURRENT_TIME=$(<span class="built_in">date</span> <span class="string">&quot;+%Y-%m-%d %H:%M:%S&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入日志信息</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[<span class="variable">$CURRENT_TIME</span>] Service is running normally.&quot;</span> &gt;&gt; <span class="string">&quot;<span class="variable">$LOG_FILE</span>&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>给予下文件权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x /path/to/write_log.sh</span><br></pre></td></tr></table></figure>


<h3 id="3-将任务1中创建的项目smart-police-system远程复制至主机jupyter对应的-root目录下。"><a href="#3-将任务1中创建的项目smart-police-system远程复制至主机jupyter对应的-root目录下。" class="headerlink" title="3 将任务1中创建的项目smart-police-system远程复制至主机jupyter对应的 &#x2F;root目录下。"></a>3 将任务1中创建的项目<code>smart-police-system</code>远程复制至主机<code>jupyter</code>对应的 &#x2F;root目录下。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -r /root/smart-police-system/ root@jupyter:/root/</span><br></pre></td></tr></table></figure>

<h3 id="4-为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write-log-sh脚本。"><a href="#4-为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write-log-sh脚本。" class="headerlink" title="4. 为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write_log.sh脚本。"></a>4. 为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write_log.sh脚本。</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;注意&#x3D;&#x3D; 如果没有给予脚本权限，可能会出错</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">*/5 * * * * /bin/bash /path/to/write_log.sh</span><br></pre></td></tr></table></figure>



<h2 id="伪分布式集群搭建"><a href="#伪分布式集群搭建" class="headerlink" title="伪分布式集群搭建"></a>伪分布式集群搭建</h2><h3 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h3><h4 id="1-修改主机名为-qingjiao"><a href="#1-修改主机名为-qingjiao" class="headerlink" title="1. 修改主机名为 qingjiao"></a>1. 修改主机名为 <code>qingjiao</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> hostnamectl set-hostname qingjiao</span><br><span class="line"></span><br><span class="line">bash</span><br></pre></td></tr></table></figure>


<h4 id="2-创建文件夹-root-task"><a href="#2-创建文件夹-root-task" class="headerlink" title="2. 创建文件夹 /root/task"></a>2. 创建文件夹 <code>/root/task</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> /root/task</span><br></pre></td></tr></table></figure>


<h4 id="3-创建文件-root-task-student"><a href="#3-创建文件-root-task-student" class="headerlink" title="3. 创建文件 /root/task/student"></a>3. 创建文件 <code>/root/task/student</code></h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /root/task/student</span><br></pre></td></tr></table></figure>


<h4 id="4-修改-hosts-文件添加主机名映射"><a href="#4-修改-hosts-文件添加主机名映射" class="headerlink" title="4. 修改 hosts 文件添加主机名映射"></a>4. 修改 <code>hosts</code> 文件添加主机名映射</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">touch</span> /root/task/student</span><br></pre></td></tr></table></figure>

<h4 id="5-修改时区为上海时间"><a href="#5-修改时区为上海时间" class="headerlink" title="5. 修改时区为上海时间"></a>5. 修改时区为上海时间</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> timedatectl set-timezone Asia/Shanghai</span><br></pre></td></tr></table></figure>

<p>该命令将系统时区更改为上海时区（CST+0800时区）。</p>
<h4 id="6-添加定时任务"><a href="#6-添加定时任务" class="headerlink" title="6. 添加定时任务"></a>6. 添加定时任务</h4><p>编辑 <code>crontab</code> 文件：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>

<p>在 <code>crontab</code> 文件中添加以下行：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 10 * * * <span class="built_in">date</span> &gt;&gt; /root/task/student</span><br></pre></td></tr></table></figure>



<h3 id="SSH免密配置"><a href="#SSH免密配置" class="headerlink" title="SSH免密配置"></a>SSH免密配置</h3><h4 id="1-节点中生成公钥文件id-rsa-pub-数字签名RSA，用户root，主机名qingjiao"><a href="#1-节点中生成公钥文件id-rsa-pub-数字签名RSA，用户root，主机名qingjiao" class="headerlink" title="1. 节点中生成公钥文件id_rsa.pub(数字签名RSA，用户root，主机名qingjiao)"></a>1. 节点中生成公钥文件id_rsa.pub(数字签名RSA，用户root，主机名qingjiao)</h4><p> </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 master 上执行如下命令生成公私密钥：（注意 master 上执行，默认为 rsa 类型）</span></span><br><span class="line"></span><br><span class="line">ssh-keygen</span><br><span class="line"></span><br><span class="line"><span class="comment"># 然后将公钥文件内容添加到授权文件。</span></span><br><span class="line"></span><br><span class="line">ssh-copy-id -i /root/.ssh/id_rsa.pub qingjiao</span><br><span class="line"></span><br><span class="line"><span class="comment"># (或者使用 localhost 也可已完成本地免密)</span></span><br></pre></td></tr></table></figure>


<h4 id="2-建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）"><a href="#2-建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）" class="headerlink" title="2. 建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）"></a>2. 建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh root@localhost</span><br></pre></td></tr></table></figure>

<h3 id="JDK安装"><a href="#JDK安装" class="headerlink" title="JDK安装"></a>JDK安装</h3><h4 id="1-将jdk安装包解压到-usr-java目录（安装包存放于-usr-package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）"><a href="#1-将jdk安装包解压到-usr-java目录（安装包存放于-usr-package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）" class="headerlink" title="1.将jdk安装包解压到&#x2F;usr&#x2F;java目录（安装包存放于&#x2F;usr&#x2F;package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）"></a>1.将jdk安装包解压到&#x2F;usr&#x2F;java目录（安装包存放于&#x2F;usr&#x2F;package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /usr/java</span><br><span class="line"><span class="built_in">cd</span> /usr/java</span><br><span class="line">tar -zxvf /usr/package277/jdk-8u221-linux-x64.tar.gz -C /usr/java/</span><br></pre></td></tr></table></figure>


<h3 id="2-配置系统环境变量JAVA-HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本"><a href="#2-配置系统环境变量JAVA-HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本" class="headerlink" title="2. 配置系统环境变量JAVA_HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本"></a>2. 配置系统环境变量JAVA_HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>

<p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_221</span><br><span class="line">export CLASSPATH=$JAVA_HOME/lib/</span><br><span class="line">export PATH=$PATH:$JAVA_HOME/bin</span><br><span class="line">export PATH JAVA_HOME CLASSPATH</span><br></pre></td></tr></table></figure>

<ul>
<li>生效环境变量：<code>source /etc/profile</code></li>
<li>查看 java 版本：<code>java -version</code></li>
</ul>
<h3 id="Hadoo伪集群部署"><a href="#Hadoo伪集群部署" class="headerlink" title="Hadoo伪集群部署"></a>Hadoo伪集群部署</h3><h4 id="1-将Hadoop安装包解压到指定路径-usr-hadoop（安装包存放于-usr-package277-）"><a href="#1-将Hadoop安装包解压到指定路径-usr-hadoop（安装包存放于-usr-package277-）" class="headerlink" title="1. 将Hadoop安装包解压到指定路径&#x2F;usr&#x2F;hadoop（安装包存放于&#x2F;usr&#x2F;package277&#x2F;）"></a>1. 将Hadoop安装包解压到指定路径&#x2F;usr&#x2F;hadoop（安装包存放于&#x2F;usr&#x2F;package277&#x2F;）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /usr/hadoop &amp;&amp; <span class="built_in">cd</span> /usr/hadoop</span><br><span class="line"></span><br><span class="line">tar -zxvf /usr/package277/hadoop-2.7.7.tar.gz -C /usr/hadoop/</span><br></pre></td></tr></table></figure>

<h4 id="2-配置环境变量HADOOP-HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量"><a href="#2-配置环境变量HADOOP-HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量" class="headerlink" title="2. 配置环境变量HADOOP_HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量"></a>2. 配置环境变量HADOOP_HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br></pre></td></tr></table></figure>


<p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#hadoop</span><br><span class="line">#配置 Hadoop 安装目录</span><br><span class="line">export HADOOP_HOME=/usr/hadoop/hadoop-2.7.7</span><br><span class="line">#在原 PATH 基础上加入 Hadoop 的 bin 和 sbin 目录</span><br><span class="line">export PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></table></figure>


<h4 id="3-配置Hadoop运行环境JAVA-HOME-hadoop-env-sh"><a href="#3-配置Hadoop运行环境JAVA-HOME-hadoop-env-sh" class="headerlink" title="3. 配置Hadoop运行环境JAVA_HOME(hadoop-env.sh)"></a>3. 配置Hadoop运行环境JAVA_HOME(hadoop-env.sh)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> <span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br><span class="line">vim hadoop-env.sh</span><br></pre></td></tr></table></figure>

<p>添加</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_221</span><br></pre></td></tr></table></figure>


<h4 id="4-设置全局参数，指定HDFS上NameNode地址为qingjiao-端口默认为9000-core-site-xml"><a href="#4-设置全局参数，指定HDFS上NameNode地址为qingjiao-端口默认为9000-core-site-xml" class="headerlink" title="4. 设置全局参数，指定HDFS上NameNode地址为qingjiao,端口默认为9000(core-site.xml)"></a>4. 设置全局参数，指定HDFS上NameNode地址为qingjiao,端口默认为9000(core-site.xml)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim core-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;/configuration&gt;中添加</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.default.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 用于指定 NameNode 的地址 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://qingjiao:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- Hadoop 运行时产生文件的临时存储目录 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/tmp<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>




<h4 id="5-设置全局参数，指定临时存储目录为本地-root-hadoopData-tmp-要求为绝对路径，下同"><a href="#5-设置全局参数，指定临时存储目录为本地-root-hadoopData-tmp-要求为绝对路径，下同" class="headerlink" title="5. 设置全局参数，指定临时存储目录为本地&#x2F;root&#x2F;hadoopData&#x2F;tmp(要求为绝对路径，下同)"></a>5. 设置全局参数，指定临时存储目录为本地&#x2F;root&#x2F;hadoopData&#x2F;tmp(要求为绝对路径，下同)</h4><p>接上</p>
<h4 id="6-设置HDFS参数，指定备份文本数量为1（hdfs-site-xml）"><a href="#6-设置HDFS参数，指定备份文本数量为1（hdfs-site-xml）" class="headerlink" title="6. 设置HDFS参数，指定备份文本数量为1（hdfs-site.xml）"></a>6. 设置HDFS参数，指定备份文本数量为1（hdfs-site.xml）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim hdfs-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;/configuration&gt;中添加</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 数据块副本的数量，默认为 3 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>1<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.namenode.name.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- NameNode 在本地文件系统中持久存储命名空间和事务日志的路径 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/name<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.data.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- DataNode 在本地文件系统中存放块的路径 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/root/hadoopData/data<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 关闭 hadoop 集群权限校验 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.datanode.use.datanode.hostname<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- datanode 之间的通信也通过域名方式 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>



<h4 id="7-设置HDFS参数，指定NN存放元数据信息路径为本地-root-hadoopData-name；指定DN存放元数据信息路径为本地-root-hadoopData-data-要求为绝对路径"><a href="#7-设置HDFS参数，指定NN存放元数据信息路径为本地-root-hadoopData-name；指定DN存放元数据信息路径为本地-root-hadoopData-data-要求为绝对路径" class="headerlink" title="7. 设置HDFS参数，指定NN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;name；指定DN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;data(要求为绝对路径)"></a>7. 设置HDFS参数，指定NN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;name；指定DN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;data(要求为绝对路径)</h4><p>接上</p>
<h4 id="8-设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群"><a href="#8-设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群" class="headerlink" title="8. 设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群"></a>8. 设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群</h4><p>接上</p>
<h4 id="9-设置YARN运行环境-JAVA-HOME参数-yarn-env-sh"><a href="#9-设置YARN运行环境-JAVA-HOME参数-yarn-env-sh" class="headerlink" title="9. 设置YARN运行环境$JAVA_HOME参数(yarn-env.sh)"></a>9. 设置YARN运行环境$JAVA_HOME参数(yarn-env.sh)</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-env.sh</span><br></pre></td></tr></table></figure>

<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_221</span><br></pre></td></tr></table></figure>



<h4 id="10-设置YARN核心参数，指定mapreduce-获取数据的方式为mapreduce-shuffle（yarn-site-xml）"><a href="#10-设置YARN核心参数，指定mapreduce-获取数据的方式为mapreduce-shuffle（yarn-site-xml）" class="headerlink" title="10. 设置YARN核心参数，指定mapreduce 获取数据的方式为mapreduce_shuffle（yarn-site.xml）"></a>10. 设置YARN核心参数，指定mapreduce 获取数据的方式为mapreduce_shuffle（yarn-site.xml）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim yarn-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;/configuration&gt;中添加</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.resourcemanager.admin.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>qingjiao:18141<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.aux-services<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 指定 reducer 获取数据的方式--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- NodeManager 上运行的附属服务，也可以理解为 mapreduce 获取数据的方式 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>mapreduce_shuffle<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>yarn.nodemanager.auxservices.mapreduce.shuffle.class<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>org.apache.hadoop.mapred.ShuffleHandler<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>




<h4 id="11-设置计算框架参数，指定MR运行在yarn上（mapred-site-xml）"><a href="#11-设置计算框架参数，指定MR运行在yarn上（mapred-site-xml）" class="headerlink" title="11. 设置计算框架参数，指定MR运行在yarn上（mapred-site.xml）"></a>11. 设置计算框架参数，指定MR运行在yarn上（mapred-site.xml）</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> mapred-site.xml.template mapred-site.xml &amp;&amp; vim mapred-site.xml</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;configuration&gt;</span><br><span class="line">&lt;/configuration&gt;中添加</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!--指定 Mapreduce 运行在 yarn 上--&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 指定使用 YARN 运行 MapReduce 程序，默认为 local --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h4 id="12-设置节点文件slaves，要求qingjiao为子节点"><a href="#12-设置节点文件slaves，要求qingjiao为子节点" class="headerlink" title="12. 设置节点文件slaves，要求qingjiao为子节点"></a>12. 设置节点文件slaves，要求qingjiao为子节点</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> qingjiao &gt; slaves</span><br></pre></td></tr></table></figure>

<h4 id="13-对文件系统进行格式化"><a href="#13-对文件系统进行格式化" class="headerlink" title="13. 对文件系统进行格式化"></a>13. 对文件系统进行格式化</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop namenode -format</span><br></pre></td></tr></table></figure>

<h4 id="14-启动Hadoop集群查看各节点服务"><a href="#14-启动Hadoop集群查看各节点服务" class="headerlink" title="14. 启动Hadoop集群查看各节点服务"></a>14. 启动Hadoop集群查看各节点服务</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">start-all.sh</span><br></pre></td></tr></table></figure>

<p>出错的话</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">stop-all.sh</span><br><span class="line">start-all.sh</span><br></pre></td></tr></table></figure>

<h4 id="15-查看集群运行状态是否正常"><a href="#15-查看集群运行状态是否正常" class="headerlink" title="15. 查看集群运行状态是否正常"></a>15. 查看集群运行状态是否正常</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfsadmin -report</span><br></pre></td></tr></table></figure>



<h2 id="交通事故数据分析"><a href="#交通事故数据分析" class="headerlink" title="交通事故数据分析"></a>交通事故数据分析</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">data = pd.read_excel(<span class="string">&quot;./事故数据.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 1. 对全量数据的&quot;事故严重性&quot;分布构成进行分析</span></span><br><span class="line">severity_distribution = data[<span class="string">&#x27;事故严重性&#x27;</span>].value_counts(normalize=<span class="literal">True</span>).reset_index()</span><br><span class="line">severity_distribution.columns = [<span class="string">&#x27;事故严重性&#x27;</span>, <span class="string">&#x27;占比&#x27;</span>]</span><br><span class="line">severity_distribution[<span class="string">&#x27;事故数&#x27;</span>] = severity_distribution[<span class="string">&#x27;占比&#x27;</span>] * <span class="built_in">len</span>(data)</span><br><span class="line">severity_distribution[<span class="string">&#x27;占比&#x27;</span>] = severity_distribution[<span class="string">&#x27;占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line">severity_distribution.drop_duplicates(inplace=<span class="literal">True</span>)</span><br><span class="line">severity_distribution.to_csv(<span class="string">&#x27;01.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2. 在“特别严重”的事故数据中，对“事故车辆“的分布构成进行分析</span></span><br><span class="line">severe_data = data[data[<span class="string">&#x27;事故严重性&#x27;</span>] == <span class="number">3</span>]</span><br><span class="line">severe_data</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vehicle_distribution = severe_data[<span class="string">&#x27;事故车辆&#x27;</span>].value_counts(normalize=<span class="literal">True</span>).reset_index()</span><br><span class="line">vehicle_distribution.columns = [<span class="string">&#x27;事故车辆&#x27;</span>, <span class="string">&#x27;占比&#x27;</span>]</span><br><span class="line">vehicle_distribution[<span class="string">&#x27;事故数&#x27;</span>] = vehicle_distribution[<span class="string">&#x27;占比&#x27;</span>] * <span class="built_in">len</span>(severe_data)</span><br><span class="line">vehicle_distribution[<span class="string">&#x27;占比&#x27;</span>] = vehicle_distribution[<span class="string">&#x27;占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line">vehicle_distribution.to_csv(<span class="string">&#x27;02.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 3. 分析“高速”道路中5车及以上事故车辆对应的“平均伤亡人数”</span></span><br><span class="line">highway_data = data[(data[<span class="string">&#x27;一类道路&#x27;</span>] == <span class="number">1</span>) &amp; (data[<span class="string">&#x27;事故车辆&#x27;</span>] &gt;= <span class="number">5</span>)]</span><br><span class="line">highway_data</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">average_casualties = highway_data.groupby(<span class="string">&#x27;事故车辆&#x27;</span>)[<span class="string">&#x27;伤亡人数&#x27;</span>].mean().reset_index()</span><br><span class="line">average_casualties.columns = [<span class="string">&#x27;事故车辆&#x27;</span>, <span class="string">&#x27;平均伤亡人数&#x27;</span>]</span><br><span class="line">average_casualties[<span class="string">&#x27;事故数&#x27;</span>] = highway_data[<span class="string">&#x27;事故车辆&#x27;</span>].value_counts().reindex(average_casualties[<span class="string">&#x27;事故车辆&#x27;</span>], fill_value=<span class="number">0</span>)</span><br><span class="line">average_casualties.to_csv(<span class="string">&#x27;03.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 4. 对全量数据进行时间（周）分布分析</span></span><br><span class="line"><span class="comment"># 咨询全量数据中周的分布情况</span></span><br><span class="line">weekly_distribution = data[<span class="string">&#x27;周（星期）&#x27;</span>].value_counts().reset_index()</span><br><span class="line"><span class="comment"># 重命名列名</span></span><br><span class="line">weekly_distribution.columns = [<span class="string">&#x27;周&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>]</span><br><span class="line"><span class="comment"># 计算各周事故数占总事故数的比例</span></span><br><span class="line">weekly_distribution[<span class="string">&#x27;事故占比&#x27;</span>] = weekly_distribution[<span class="string">&#x27;事故数&#x27;</span>] / <span class="built_in">len</span>(data)</span><br><span class="line"><span class="comment"># 按周的顺序排序（可选操作，若周的数值本身没有顺序则无需排序）</span></span><br><span class="line">weekly_distribution.sort_values(by=<span class="string">&#x27;周&#x27;</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 将结果保存到04.txt文件中，指定分隔符为空格，不包含索引和列名</span></span><br><span class="line">weekly_distribution.to_csv(<span class="string">&#x27;04.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># 5. 对全量数据进行道路类型分布分析</span></span><br><span class="line">road_type_distribution = data[<span class="string">&#x27;道路类型&#x27;</span>].value_counts(normalize=<span class="literal">True</span>).reset_index()</span><br><span class="line">road_type_distribution.columns = [<span class="string">&#x27;道路类型&#x27;</span>, <span class="string">&#x27;占比&#x27;</span>]</span><br><span class="line">road_type_distribution[<span class="string">&#x27;事故数&#x27;</span>] = road_type_distribution[<span class="string">&#x27;占比&#x27;</span>] * <span class="built_in">len</span>(data)</span><br><span class="line">road_type_distribution[<span class="string">&#x27;占比&#x27;</span>] = road_type_distribution[<span class="string">&#x27;占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x:<span class="number">.2</span>%&#125;</span>&quot;</span>)</span><br><span class="line">road_type_distribution.to_csv(<span class="string">&#x27;05.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 6. 分析“学校道路”下事故限速情况分布</span></span><br><span class="line">school_road_data = data[data[<span class="string">&#x27;道路类型&#x27;</span>] == <span class="number">9</span>]</span><br><span class="line">speed_limit_distribution = school_road_data[<span class="string">&#x27;限速情况&#x27;</span>].value_counts().reset_index()</span><br><span class="line">speed_limit_distribution.columns = [<span class="string">&#x27;限速情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>]</span><br><span class="line">speed_limit_distribution[<span class="string">&#x27;数据占比&#x27;</span>] = speed_limit_distribution[<span class="string">&#x27;事故数&#x27;</span>] / <span class="built_in">len</span>(school_road_data)</span><br><span class="line">speed_limit_distribution[<span class="string">&#x27;数据占比(%)&#x27;</span>] = speed_limit_distribution[<span class="string">&#x27;数据占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x * <span class="number">100</span>:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">speed_limit_distribution = speed_limit_distribution[[<span class="string">&#x27;限速情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>, <span class="string">&#x27;数据占比(%)&#x27;</span>]]</span><br><span class="line">speed_limit_distribution.to_csv(<span class="string">&#x27;06.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 7. 分析“乡村道路”事故中“灯光情况”构成</span></span><br><span class="line">rural_road_data = data[data[<span class="string">&#x27;道路类型&#x27;</span>] == <span class="number">3</span>]</span><br><span class="line">lighting_distribution = rural_road_data[<span class="string">&#x27;灯光情况&#x27;</span>].value_counts().reset_index()</span><br><span class="line">lighting_distribution.columns = [<span class="string">&#x27;灯光情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>]</span><br><span class="line">lighting_distribution[<span class="string">&#x27;数据占比&#x27;</span>] = lighting_distribution[<span class="string">&#x27;事故数&#x27;</span>] / <span class="built_in">len</span>(rural_road_data)</span><br><span class="line">lighting_distribution[<span class="string">&#x27;数据占比(%)&#x27;</span>] = lighting_distribution[<span class="string">&#x27;数据占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x * <span class="number">100</span>:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">lighting_distribution = lighting_distribution[[<span class="string">&#x27;灯光情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>, <span class="string">&#x27;数据占比(%)&#x27;</span>]]</span><br><span class="line">lighting_distribution.to_csv(<span class="string">&#x27;07.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 8. 分析“城市道路”事故中“天气情况”构成</span></span><br><span class="line">urban_road_data = data[data[<span class="string">&#x27;道路类型&#x27;</span>] == <span class="number">2</span>]</span><br><span class="line">weather_distribution = urban_road_data[<span class="string">&#x27;天气情况&#x27;</span>].value_counts().reset_index()</span><br><span class="line">weather_distribution.columns = [<span class="string">&#x27;天气情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>]</span><br><span class="line">weather_distribution[<span class="string">&#x27;数据占比&#x27;</span>] = weather_distribution[<span class="string">&#x27;事故数&#x27;</span>] / <span class="built_in">len</span>(urban_road_data)</span><br><span class="line">weather_distribution[<span class="string">&#x27;数据占比(%)&#x27;</span>] = weather_distribution[<span class="string">&#x27;数据占比&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">f&quot;<span class="subst">&#123;x * <span class="number">100</span>:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line">weather_distribution = weather_distribution[[<span class="string">&#x27;天气情况&#x27;</span>, <span class="string">&#x27;事故数&#x27;</span>, <span class="string">&#x27;数据占比(%)&#x27;</span>]]</span><br><span class="line">weather_distribution.to_csv(<span class="string">&#x27;08.txt&#x27;</span>, index=<span class="literal">False</span>, sep=<span class="string">&#x27; &#x27;</span>, header=<span class="literal">False</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="电信诈骗数据分析（Python）"><a href="#电信诈骗数据分析（Python）" class="headerlink" title="电信诈骗数据分析（Python）"></a>电信诈骗数据分析（Python）</h2><h4 id="背景说明"><a href="#背景说明" class="headerlink" title="背景说明"></a>背景说明</h4><p>随着移动支付的迅速发展，电信诈骗案件不断增加。在如此严峻的形势下，如何有效地检测欺诈行为成为一个亟待解决的挑战。为了应对这一挑战，我们收集了约40万条银行卡交易记录，其中包含了七个关键特征以及一个标签”fraud”。这些特征包括交易地点、最近交易金额与历史交易金额的对比、是否使用PIN码等。通过对这些给定数据集的探索性分析，我们可以揭示被骗者的银行卡交易特征，从而协助反诈警务人员及时发出预警信息，有效保护人民的财产安全。我们的研究旨在利用这些数据和特征，为社会提供更有效的防范措施，减少诈骗事件对个人和社会造成的损失。</p>
<table>
<thead>
<tr>
<th>列名</th>
<th>类型</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>distance_from_home</td>
<td>float64</td>
<td>银行卡交易地点与家的距离</td>
</tr>
<tr>
<td>distance_from_last_transaction</td>
<td>float64</td>
<td>与上次交易发生的距离</td>
</tr>
<tr>
<td>ratio_to_median_purchase_price</td>
<td>float64</td>
<td>近一次交易与以往交易价格中位数的比率</td>
</tr>
<tr>
<td>repeat_retailer</td>
<td>float64</td>
<td>交易是否发生在同一个商户</td>
</tr>
<tr>
<td>used_chip</td>
<td>float64</td>
<td>是通过芯片（银行卡）进行的交易</td>
</tr>
<tr>
<td>used_pin_number</td>
<td>float64</td>
<td>交易时是否使用了PIN码</td>
</tr>
<tr>
<td>online_order</td>
<td>float64</td>
<td>是否是在线交易订单</td>
</tr>
<tr>
<td>fraud</td>
<td>float64</td>
<td>诈骗片行为（标签）</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 导包</span></span><br><span class="line">%matplotlib inline</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> matplotlib.ticker <span class="keyword">as</span> ticker</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> tzinfo,timedelta,datetime</span><br><span class="line"><span class="comment"># 消除一些警告</span></span><br><span class="line"><span class="keyword">import</span> warnings</span><br><span class="line">warnings.simplefilter(<span class="string">&#x27;ignore&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置显示中文字体，</span></span><br><span class="line"><span class="comment"># 设置font.sans-serif 或 font.family 均可</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.sans-serif&quot;</span>] = [<span class="string">&quot;Arial Unicode MS&quot;</span>] <span class="comment">## mac</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>]=[<span class="string">&#x27;Arial Unicode MS&#x27;</span>] <span class="comment">## mac</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;font.sans-serif&quot;</span>] = [<span class="string">&quot;SimHei&quot;</span>] <span class="comment">## win</span></span><br><span class="line">plt.rcParams[<span class="string">&#x27;font.family&#x27;</span>]=[<span class="string">&#x27;SimHei&#x27;</span>] <span class="comment">## win</span></span><br><span class="line"><span class="comment"># 设置正常显示符号</span></span><br><span class="line">plt.rcParams[<span class="string">&quot;axes.unicode_minus&quot;</span>] = <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h1 id="一、探索性分析"><a href="#一、探索性分析" class="headerlink" title="一、探索性分析"></a>一、探索性分析</h1><ul>
<li>读取数据</li>
<li>查看数据类型</li>
<li>空值检测</li>
<li>异常值检测</li>
<li>正负样本分布</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 读取CSV文件</span></span><br><span class="line"></span><br><span class="line">data = pd.read_csv(<span class="string">&#x27;./data/Card_data.csv&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(data.shape) <span class="comment"># 查看数量形状</span></span><br><span class="line">data.head(<span class="number">10</span>) <span class="comment"># 查看前十条数据</span></span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看表 data中各列基本信息，包括：列名、数量、数据类型等。</span></span><br><span class="line">data.info()</span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看数据集各列的数据统计情况</span></span><br><span class="line"></span><br><span class="line">data.describe() </span><br></pre></td></tr></table></figure>




<p>可以观察到distance_from_home（银行卡交易地点与家的距离）和distance_from_last_transaction（与上次交易发生的距离）的方差相对于其他特征很大</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计是否被诈骗数量分布</span></span><br><span class="line"></span><br><span class="line">num_fraud = data[data[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">1.0</span>].shape[<span class="number">0</span>]    <span class="comment"># fraud = 1.0 表示 被诈骗数据</span></span><br><span class="line">num_no_fraud = data[data[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">0.0</span>].shape[<span class="number">0</span>] <span class="comment"># fraud = 0.0 表示 未被诈骗数据</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(num_fraud,num_no_fraud)</span><br><span class="line"></span><br><span class="line"><span class="comment">##绘制正负样本百分比图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">labels = [<span class="string">&#x27;fraud&#x27;</span>, <span class="string">&#x27;Not fraud&#x27;</span>]</span><br><span class="line">sizes = [num_fraud, num_no_fraud]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制饼图</span></span><br><span class="line">plt.pie(sizes, labels=labels,colors=[<span class="string">&#x27;#fdbf9c&#x27;</span>,<span class="string">&#x27;#d6f9d1&#x27;</span>], autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, textprops=&#123;<span class="string">&#x27;fontsize&#x27;</span>: <span class="number">13</span>&#125;,startangle=<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加标题</span></span><br><span class="line">plt.title(<span class="string">&#x27;是否被诈骗数量分布百分比图&#x27;</span>,fontsize=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示图形</span></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 基于箱型图，检测异常值</span></span><br><span class="line"> </span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">d1 = data[<span class="string">&#x27;distance_from_home&#x27;</span>]</span><br><span class="line">d2 = data[<span class="string">&#x27;distance_from_last_transaction&#x27;</span>]</span><br><span class="line">d3 = data[<span class="string">&#x27;ratio_to_median_purchase_price&#x27;</span>]</span><br><span class="line">d4 = data[<span class="string">&#x27;repeat_retailer&#x27;</span>]</span><br><span class="line">d5 = data[<span class="string">&#x27;used_chip&#x27;</span>]</span><br><span class="line">d6 = data[<span class="string">&#x27;used_pin_number&#x27;</span>]</span><br><span class="line">d7 = data[<span class="string">&#x27;online_order&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制各类别异常值分析箱型图</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">8</span>))</span><br><span class="line">plt.title(<span class="string">&#x27;各类别异常值分析箱型图&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">label = <span class="string">&#x27;distance_from_home&#x27;</span>, <span class="string">&#x27;distance_from_last_transaction&#x27;</span>, <span class="string">&#x27;ratio_to_median_purchase_price&#x27;</span>, <span class="string">&#x27;repeat_retailer&#x27;</span>, <span class="string">&#x27;used_chip&#x27;</span>, <span class="string">&#x27;used_pin_number&#x27;</span>, <span class="string">&#x27;online_order&#x27;</span></span><br><span class="line">plt.boxplot([d1, d2, d3, d4, d5, d6, d7], labels=label)  <span class="comment"># label设置横轴每个箱图对应的横坐标</span></span><br><span class="line">plt.xticks(rotation=<span class="number">45</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;变量&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;变量值&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line"> </span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>



<h1 id="二、整体特征分析，观察特征之间的相关性"><a href="#二、整体特征分析，观察特征之间的相关性" class="headerlink" title="二、整体特征分析，观察特征之间的相关性"></a>二、整体特征分析，观察特征之间的相关性</h1><ul>
<li>第一步：创建2个新表， Fraud 和 NotFraud, 分别对应 被诈骗数据 和 未被诈骗数据</li>
<li>第二步：求得相关性，画出热力图进行分析</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一步：创建新表Fraud 【被诈骗数据】</span></span><br><span class="line"></span><br><span class="line">Fraud = data[data[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看表Fraud的形状：&#x27;</span>, Fraud.shape)</span><br><span class="line">Fraud.head()   <span class="comment"># 查看 表Fraud 的前5行</span></span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建新表 NotFraud 【未被诈骗数据】</span></span><br><span class="line">NotFraud = data[data[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">0</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看表NotFraud的形状：&#x27;</span>, NotFraud.shape)</span><br><span class="line">NotFraud.head() <span class="comment"># 查看 表NotFraud 的前5行</span></span><br></pre></td></tr></table></figure>








<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#第 2步：计算 表NotFraud 的相关性 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里计算 除 fraud列 的剩余7列的相关性</span></span><br><span class="line">corr_Fraud = Fraud.loc[:, Fraud.columns != <span class="string">&#x27;fraud&#x27;</span>].corr()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看计算结果</span></span><br><span class="line">corr_Fraud</span><br></pre></td></tr></table></figure>








<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#计算 表NotFraud 的相关性 </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里计算 除 fraud列 的剩余7列的相关性，因为 fraud是标签不算特征</span></span><br><span class="line">corr_NotFraud = NotFraud.loc[:, NotFraud.columns != <span class="string">&#x27;fraud&#x27;</span>].corr()</span><br><span class="line"><span class="comment"># 查看计算结果</span></span><br><span class="line">corr_NotFraud</span><br></pre></td></tr></table></figure>





<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 绘制热力图，观察各个特征之间的相关性</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建图像</span></span><br><span class="line">grid_kws = &#123;<span class="string">&quot;width_ratios&quot;</span>: (<span class="number">.9</span>, <span class="number">.9</span>, <span class="number">.05</span>), <span class="string">&quot;wspace&quot;</span>: <span class="number">0.2</span>&#125;</span><br><span class="line">f, (ax1, ax2, cbar_ax) = plt.subplots(<span class="number">1</span>, <span class="number">3</span>, gridspec_kw=grid_kws, figsize = (<span class="number">18</span>, <span class="number">9</span>))</span><br><span class="line"><span class="comment"># 定义调色板</span></span><br><span class="line">cmap = sns.diverging_palette(<span class="number">0</span>, <span class="number">230</span>, <span class="number">90</span>, <span class="number">60</span>, as_cmap=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 画 NotFraud 表中的各个特征间相关性热力图</span></span><br><span class="line"><span class="comment"># 计算上三角mask矩阵</span></span><br><span class="line">mask1 = np.zeros_like(corr_NotFraud)</span><br><span class="line">indices = np.triu_indices_from(corr_NotFraud)</span><br><span class="line">mask1[indices] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤空值</span></span><br><span class="line">mask1 = mask1[<span class="number">1</span>:, :-<span class="number">1</span>]</span><br><span class="line">corr_NotFraud = corr_NotFraud.iloc[<span class="number">1</span>:, :-<span class="number">1</span>].copy()</span><br><span class="line">ax1 =sns.heatmap(corr_NotFraud, ax = ax1, vmin = -<span class="number">1</span>, vmax = <span class="number">1</span>, cmap = cmap, square = <span class="literal">False</span>, \</span><br><span class="line">                  annot=<span class="literal">True</span>, fmt=<span class="string">&quot;.2f&quot;</span>, linewidths = <span class="number">0.5</span>, mask = mask1, cbar = <span class="literal">False</span>)</span><br><span class="line">ax1.set_xticklabels(ax1.get_xticklabels(), size = <span class="number">16</span>); </span><br><span class="line">ax1.set_yticklabels(ax1.get_yticklabels(), size = <span class="number">16</span>); </span><br><span class="line">ax1.set_title(<span class="string">&#x27;fraud=1的热力图&#x27;</span>, size = <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 画 Fraud 表中的各个特征间相关性热力图</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算上三角mask矩阵</span></span><br><span class="line">mask2 = np.zeros_like(corr_Fraud)</span><br><span class="line">indices = np.triu_indices_from(corr_Fraud)</span><br><span class="line">mask2[indices] = <span class="literal">True</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 过滤空值</span></span><br><span class="line">mask2 = mask2[<span class="number">1</span>:, :-<span class="number">1</span>]</span><br><span class="line">corr_Fraud = corr_Fraud.iloc[<span class="number">1</span>:, :-<span class="number">1</span>].copy()</span><br><span class="line"></span><br><span class="line">ax2 = sns.heatmap(corr_Fraud, vmin = -<span class="number">1</span>, vmax = <span class="number">1</span>, cmap = cmap, ax = ax2, square = <span class="literal">False</span>, \</span><br><span class="line">                  linewidths = <span class="number">0.5</span>, mask = mask2, yticklabels = <span class="literal">False</span>, \</span><br><span class="line">                  annot=<span class="literal">True</span>, fmt=<span class="string">&quot;.2f&quot;</span>, cbar_ax = cbar_ax, cbar_kws=&#123;<span class="string">&#x27;orientation&#x27;</span>: <span class="string">&#x27;vertical&#x27;</span>,  <span class="string">&#x27;ticks&#x27;</span>: [-<span class="number">1</span>, -<span class="number">0.5</span>, <span class="number">0</span>, <span class="number">0.5</span>, <span class="number">1</span>]&#125;)</span><br><span class="line"></span><br><span class="line">ax2.set_xticklabels(ax2.get_xticklabels(), size = <span class="number">16</span>);</span><br><span class="line">ax2.set_title(<span class="string">&#x27;fraud=0的热力图&#x27;</span>, size = <span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">cbar_ax.set_yticklabels(cbar_ax.get_yticklabels(), size = <span class="number">14</span>);</span><br><span class="line"></span><br><span class="line">plt.show()    <span class="comment"># 展示图像</span></span><br></pre></td></tr></table></figure>



<h1 id="三、分组聚合分析"><a href="#三、分组聚合分析" class="headerlink" title="三、分组聚合分析"></a>三、分组聚合分析</h1><ul>
<li><p>任务一：分析 <code>distance_from_home</code>与<code>fraud</code>之间的关系，旨在协助反诈警务人员锁定诈骗集团的位置范围；</p>
</li>
<li><p>任务二：分析 <code> ratio_to_median_purchase_price近一次交易与以往交易价格中位数的比率</code> 与 <code> fraud</code> 之间的关系，若比率增大，考虑有被电信诈骗的可能【这里假设比率超过10就有被骗的风险】。</p>
</li>
<li><p>任务三：分析 <code>repeat_retailer：交易是否发生在同一个商户</code> 与 <code>fraud</code> 之间的关系，假设一直在同一个商户进行交易，风险率最高。</p>
</li>
</ul>
<h2 id="3-2-任务一：分析-distance-from-home与fraud之间的关系"><a href="#3-2-任务一：分析-distance-from-home与fraud之间的关系" class="headerlink" title="3.2 任务一：分析 distance_from_home与fraud之间的关系"></a>3.2 任务一：分析 distance_from_home与fraud之间的关系</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 提取 &#x27;distance_from_home&#x27; 和 &#x27;fraud&#x27; 两列 创建新表 sub_data1</span></span><br><span class="line">sub_data1 = data[[<span class="string">&#x27;distance_from_home&#x27;</span>, <span class="string">&#x27;fraud&#x27;</span>]]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看sub_data1的形状：&#x27;</span>, sub_data1.shape)</span><br><span class="line">sub_data1.head(<span class="number">10</span>)</span><br></pre></td></tr></table></figure>

<pre><code>查看sub_data1的形状： (187403, 2)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 可视化分析： `distance_from_home交易与家间的距离` 和 `fraud是否诈骗` 之间的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 构建两个子图</span></span><br><span class="line">f, (ax1, ax2) = plt.subplots(<span class="number">2</span>, <span class="number">1</span>, sharex=<span class="literal">True</span>, figsize=(<span class="number">10</span>,<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置柱状宽度</span></span><br><span class="line">bins = <span class="number">30</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计欺诈案例的交易金额</span></span><br><span class="line">ax1.hist(sub_data1[<span class="string">&quot;distance_from_home&quot;</span>][sub_data1[<span class="string">&quot;fraud&quot;</span>]== <span class="number">1</span>], bins = bins, color=<span class="string">&#x27;#a7dbf7&#x27;</span>)</span><br><span class="line">ax1.set_title(<span class="string">&#x27;与诈骗有关&#x27;</span>)</span><br><span class="line">ax1.set_ylabel(<span class="string">&#x27;交易数量&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计正常案例的交易金额</span></span><br><span class="line">ax2.hist(sub_data1[<span class="string">&quot;distance_from_home&quot;</span>][sub_data1[<span class="string">&quot;fraud&quot;</span>]== <span class="number">0</span>], bins = bins, color=<span class="string">&#x27;#e9a8f3&#x27;</span>)</span><br><span class="line">ax2.set_title(<span class="string">&#x27;与诈骗无关&#x27;</span>)</span><br><span class="line"><span class="comment"># 画坐标系</span></span><br><span class="line">plt.xlabel(<span class="string">&#x27;距离&#x27;</span>)</span><br><span class="line">plt.ylabel(<span class="string">&#x27;交易数量&#x27;</span>)</span><br><span class="line">plt.yscale(<span class="string">&#x27;log&#x27;</span>)</span><br><span class="line">plt.show()    <span class="comment"># 展示图像</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="3-2-任务二：分析-ratio-to-median-purchase-price与-fraud之间的关系"><a href="#3-2-任务二：分析-ratio-to-median-purchase-price与-fraud之间的关系" class="headerlink" title="3.2 任务二：分析 ratio_to_median_purchase_price与 fraud之间的关系"></a>3.2 任务二：分析 <code>ratio_to_median_purchase_price</code>与 <code>fraud</code>之间的关系</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建子表sub_data2 , 该表包含 ratio_to_median_purchase_price 和 fraud 两列</span></span><br><span class="line">sub_data2 = data[[<span class="string">&#x27;ratio_to_median_purchase_price&#x27;</span>, <span class="string">&#x27;fraud&#x27;</span>]]</span><br><span class="line"><span class="comment"># 查看 sub_data2 的前5行</span></span><br><span class="line">sub_data2.head()</span><br></pre></td></tr></table></figure>







<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 ratio_to_median_purchase_price 的 数据分布</span></span><br><span class="line">sub_data2.ratio_to_median_purchase_price.describe()</span><br></pre></td></tr></table></figure>


<pre><code>count    187403.000000
mean          3.565375
std           4.653129
min           0.007278
25%           0.664047
50%           1.841595
75%           5.058910
max         266.689692
Name: ratio_to_median_purchase_price, dtype: float64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选出 ratio_to_median_purchase_price 中 大于 10 的数据，并分析他们的 fraud 的比例</span></span><br><span class="line"></span><br><span class="line">ratio = sub_data2[data[<span class="string">&#x27;ratio_to_median_purchase_price&#x27;</span>] &gt; <span class="number">10</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看表ratio的形状：&#x27;</span>, ratio.shape)</span><br><span class="line"></span><br><span class="line">ratio.head(<span class="number">10</span>) <span class="comment"># 查看 ratio的前十行</span></span><br></pre></td></tr></table></figure>

<pre><code>查看表ratio的形状： (12103, 2)
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算 表ratio中， fraud=0 以及 fraud=1的数量</span></span><br><span class="line"></span><br><span class="line">num_fraud_0 = ratio[ratio[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">0</span>]</span><br><span class="line">num_fraud_1 = ratio[ratio[<span class="string">&#x27;fraud&#x27;</span>] == <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印数值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;表ratio与诈骗无关的数据数量统计：&#x27;</span>, num_fraud_0.shape[<span class="number">0</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;表ratio与诈骗有关的数据数量统计：&#x27;</span>, num_fraud_1.shape[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<pre><code>表ratio与诈骗无关的数据数量统计： 742
表ratio与诈骗有关的数据数量统计： 11361
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可视化分析：ratio_to_median_purchase_price近一次交易与以往交易价格中位数的比率 与 fraud 之间的关系</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 数据</span></span><br><span class="line">labels = [<span class="string">&#x27;未被诈骗&#x27;</span>, <span class="string">&#x27;被诈骗&#x27;</span>]</span><br><span class="line">sizes = [num_fraud_0.shape[<span class="number">0</span>], num_fraud_1.shape[<span class="number">0</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制饼图</span></span><br><span class="line">plt.pie(sizes, labels=labels,colors=[<span class="string">&#x27;#B6A1DE&#x27;</span>,<span class="string">&#x27;#97ece5&#x27;</span>], autopct=<span class="string">&#x27;%1.1f%%&#x27;</span>, textprops=&#123;<span class="string">&#x27;fontsize&#x27;</span>: <span class="number">13</span>&#125;,startangle=<span class="number">90</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加标题</span></span><br><span class="line">plt.title(<span class="string">&#x27;`近一次交易与以往交易价格中位数的比率` 与 `fraud` 之间关系分布图&#x27;</span>,fontsize=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示图形</span></span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>



<h2 id="3-3-任务三：分析-repeat-retailer与-fraud之间的关系"><a href="#3-3-任务三：分析-repeat-retailer与-fraud之间的关系" class="headerlink" title="3.3 任务三：分析 repeat_retailer与 fraud之间的关系"></a>3.3 任务三：分析 <code>repeat_retailer</code>与 <code>fraud</code>之间的关系</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建子表sub_data3 , 该表包含 repeat_retailer 和 fraud 两列</span></span><br><span class="line"></span><br><span class="line">sub_data3 = data[[<span class="string">&#x27;repeat_retailer&#x27;</span>, <span class="string">&#x27;fraud&#x27;</span>]]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;查看表sub_data3的形状：&#x27;</span>, sub_data3.shape)</span><br><span class="line"></span><br><span class="line">sub_data3.head(<span class="number">10</span>)  <span class="comment"># 查看 表sub_data3 </span></span><br></pre></td></tr></table></figure>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看 repeat_retailer 中的数据分布</span></span><br><span class="line">sub_data3.repeat_retailer.value_counts()</span><br></pre></td></tr></table></figure>

<pre><code>1.0    165030
0.0     22373
Name: repeat_retailer, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计 repeat_retailer 中的数据 fraud =1 的数据有多少条</span></span><br><span class="line"></span><br><span class="line">sub_data3[<span class="string">&#x27;repeat_retailer&#x27;</span>][sub_data3[<span class="string">&quot;fraud&quot;</span>] == <span class="number">1</span>].value_counts()</span><br></pre></td></tr></table></figure>


<pre><code>1.0    76925
0.0    10478
Name: repeat_retailer, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 统计 repeat_retailer 中的数据 fraud =0 的数据有多少条</span></span><br><span class="line"></span><br><span class="line">sub_data3[<span class="string">&#x27;repeat_retailer&#x27;</span>][sub_data3[<span class="string">&quot;fraud&quot;</span>] == <span class="number">0</span>].value_counts()</span><br></pre></td></tr></table></figure>


<pre><code>1.0    88105
0.0    11895
Name: repeat_retailer, dtype: int64
</code></pre>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可视化分析：`repeat_retailer`是否与 `fraud` 诈骗有关</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">16</span>, <span class="number">6</span>))</span><br><span class="line">sns.distplot(sub_data3[<span class="string">&#x27;repeat_retailer&#x27;</span>][sub_data3[<span class="string">&quot;fraud&quot;</span>] == <span class="number">1</span>], bins=<span class="number">10</span>)</span><br><span class="line">sns.distplot(sub_data3[<span class="string">&#x27;repeat_retailer&#x27;</span>][sub_data3[<span class="string">&quot;fraud&quot;</span>] == <span class="number">0</span>], bins=<span class="number">20</span>)</span><br><span class="line">plt.xlabel(<span class="string">&#x27;repeat_retailer与 fraud&#x27;</span>, fontsize=<span class="number">13</span>)</span><br><span class="line">plt.title(<span class="string">&#x27;repeat_retailer与 fraud关系分布图&#x27;</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">plt.xticks([<span class="number">0</span>, <span class="number">1</span>])</span><br><span class="line">plt.show()    <span class="comment"># 展示图像</span></span><br></pre></td></tr></table></figure>




<h2 id="Mysql"><a href="#Mysql" class="headerlink" title="Mysql"></a>Mysql</h2><h3 id="1-开启-MySQL-服务"><a href="#1-开启-MySQL-服务" class="headerlink" title="1. 开启 MySQL 服务"></a>1. 开启 MySQL 服务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 MySQL 服务</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl start mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line"></span><br><span class="line">grant all privileges on *.* to <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;%&#x27;</span> with grant option;</span><br><span class="line"></span><br><span class="line">flush privileges;</span><br></pre></td></tr></table></figure>
<h3 id="2-创建数据库-relation"><a href="#2-创建数据库-relation" class="headerlink" title="2. 创建数据库 relation"></a>2. 创建数据库 <code>relation</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> relation;</span><br><span class="line">USE relation;</span><br></pre></td></tr></table></figure>

<h3 id="3-创建数据表-user-并导入数据"><a href="#3-创建数据表-user-并导入数据" class="headerlink" title="3. 创建数据表 user 并导入数据"></a>3. 创建数据表 <code>user</code> 并导入数据</h3><p>navicat导入</p>
<h3 id="4-创建数据表-friend-并导入数据"><a href="#4-创建数据表-friend-并导入数据" class="headerlink" title="4. 创建数据表 friend 并导入数据"></a>4. 创建数据表 <code>friend</code> 并导入数据</h3><p>navicat导入</p>
<p>注意时间格式</p>
<h3 id="5-分析不同用户的好友数并存储为视图-table1"><a href="#5-分析不同用户的好友数并存储为视图-table1" class="headerlink" title="5. 分析不同用户的好友数并存储为视图 table1"></a>5. 分析不同用户的好友数并存储为视图 <code>table1</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">USE relation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> table1 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> u.user_name, <span class="built_in">COUNT</span>(f.friend_id) <span class="keyword">AS</span> f_num</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">user</span> u</span><br><span class="line"><span class="keyword">LEFT</span> <span class="keyword">JOIN</span> friend f <span class="keyword">ON</span> u.user_id <span class="operator">=</span> f.user_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> u.user_id;</span><br></pre></td></tr></table></figure>

<h3 id="6-查找用户“系乐”的所有朋友信息并存储为视图-table2"><a href="#6-查找用户“系乐”的所有朋友信息并存储为视图-table2" class="headerlink" title="6. 查找用户“系乐”的所有朋友信息并存储为视图 table2"></a>6. 查找用户“系乐”的所有朋友信息并存储为视图 <code>table2</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE relation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> table2 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> u1.user_name <span class="keyword">AS</span> user_name, u2.user_name <span class="keyword">AS</span> f_name</span><br><span class="line"><span class="keyword">FROM</span> friend f</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u1 <span class="keyword">ON</span> f.user_id <span class="operator">=</span> u1.user_id</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u2 <span class="keyword">ON</span> f.friend_id <span class="operator">=</span> u2.user_id</span><br><span class="line"><span class="keyword">WHERE</span> u1.user_name <span class="operator">=</span> <span class="string">&#x27;系乐&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="7-查询用户的所有好友信息并存储为视图-table3"><a href="#7-查询用户的所有好友信息并存储为视图-table3" class="headerlink" title="7. 查询用户的所有好友信息并存储为视图 table3"></a>7. 查询用户的所有好友信息并存储为视图 <code>table3</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE relation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> table3 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> u1.user_name <span class="keyword">AS</span> user_name, GROUP_CONCAT(u2.user_name) <span class="keyword">AS</span> f_name</span><br><span class="line"><span class="keyword">FROM</span> friend f</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u1 <span class="keyword">ON</span> f.user_id <span class="operator">=</span> u1.user_id</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u2 <span class="keyword">ON</span> f.friend_id <span class="operator">=</span> u2.user_id</span><br><span class="line"><span class="keyword">GROUP</span> <span class="keyword">BY</span> u1.user_id;</span><br></pre></td></tr></table></figure>

<h3 id="8-查询“系乐”和“姚欣然”的共同好友信息并存储为视图-table4"><a href="#8-查询“系乐”和“姚欣然”的共同好友信息并存储为视图-table4" class="headerlink" title="8. 查询“系乐”和“姚欣然”的共同好友信息并存储为视图 table4"></a>8. 查询“系乐”和“姚欣然”的共同好友信息并存储为视图 <code>table4</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">USE relation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> table4 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> </span><br><span class="line">    u1.user_name <span class="keyword">AS</span> user_name1,</span><br><span class="line">    u2.user_name <span class="keyword">AS</span> user_name2,</span><br><span class="line">    f.friend_id</span><br><span class="line"><span class="keyword">FROM</span> friend f</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u1 <span class="keyword">ON</span> f.user_id <span class="operator">=</span> u1.user_id</span><br><span class="line"><span class="keyword">JOIN</span> <span class="keyword">user</span> u2 <span class="keyword">ON</span> f.friend_id <span class="operator">=</span> u2.user_id</span><br><span class="line"><span class="keyword">WHERE</span> u1.user_name <span class="operator">=</span> <span class="string">&#x27;系乐&#x27;</span> <span class="keyword">AND</span> u2.user_name <span class="operator">=</span> <span class="string">&#x27;姚欣然&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="9-进行社交网络挖掘并存储为视图-table5"><a href="#9-进行社交网络挖掘并存储为视图-table5" class="headerlink" title="9. 进行社交网络挖掘并存储为视图 table5"></a>9. 进行社交网络挖掘并存储为视图 <code>table5</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">USE relation;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">VIEW</span> table5 <span class="keyword">AS</span></span><br><span class="line"><span class="keyword">SELECT</span> u.user_id, u.user_name</span><br><span class="line"><span class="keyword">FROM</span> <span class="keyword">user</span> u</span><br><span class="line"><span class="keyword">JOIN</span> friend f1 <span class="keyword">ON</span> u.user_id <span class="operator">=</span> f1.user_id</span><br><span class="line"><span class="keyword">JOIN</span> friend f2 <span class="keyword">ON</span> f1.friend_id <span class="operator">=</span> f2.user_id</span><br><span class="line"><span class="keyword">WHERE</span> f2.friend_id <span class="operator">=</span> <span class="number">2</span> <span class="keyword">AND</span> u.user_id <span class="operator">!=</span> <span class="number">2</span>;</span><br></pre></td></tr></table></figure>

<h2 id="数据库安全管理"><a href="#数据库安全管理" class="headerlink" title="数据库安全管理"></a>数据库安全管理</h2><p>以下是针对上述要求的操作步骤：</p>
<h3 id="1-启动-MySQL-服务并查看服务状态"><a href="#1-启动-MySQL-服务并查看服务状态" class="headerlink" title="1. 启动 MySQL 服务并查看服务状态"></a>1. 启动 MySQL 服务并查看服务状态</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动 MySQL 服务</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl start mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 MySQL 服务状态</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl status mysql</span><br></pre></td></tr></table></figure>

<h3 id="2-创建用户-qingjiao"><a href="#2-创建用户-qingjiao" class="headerlink" title="2. 创建用户 qingjiao"></a>2. 创建用户 <code>qingjiao</code></h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 使用 root 用户登录 MySQL</span></span><br><span class="line">mysql <span class="operator">-</span>u root <span class="operator">-</span>p</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 输入 root 用户密码：123456</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建新用户 qingjiao</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;qingjiao&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;Qingjiao@qaz#123&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="3-授予-qingjiao-用户在-datatest-库下的-CREATE-权限"><a href="#3-授予-qingjiao-用户在-datatest-库下的-CREATE-权限" class="headerlink" title="3. 授予 qingjiao 用户在 datatest 库下的 CREATE 权限"></a>3. 授予 <code>qingjiao</code> 用户在 <code>datatest</code> 库下的 <code>CREATE</code> 权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 授予 CREATE 权限</span></span><br><span class="line"><span class="keyword">GRANT</span> <span class="keyword">CREATE</span> <span class="keyword">ON</span> datatest.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;qingjiao&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 刷新权限</span></span><br><span class="line">FLUSH PRIVILEGES;</span><br></pre></td></tr></table></figure>

<h3 id="4-切换到-qingjiao-用户并创建数据库和表"><a href="#4-切换到-qingjiao-用户并创建数据库和表" class="headerlink" title="4. 切换到 qingjiao 用户并创建数据库和表"></a>4. 切换到 <code>qingjiao</code> 用户并创建数据库和表</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到 qingjiao 用户</span></span><br><span class="line">mysql -u qingjiao -p</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据库 datatest</span></span><br><span class="line">CREATE DATABASE datatest;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到 datatest 数据库</span></span><br><span class="line">USE datatest;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建 userinfo 表</span></span><br><span class="line">CREATE TABLE userinfo (</span><br><span class="line">    <span class="built_in">id</span> INT AUTO_INCREMENT PRIMARY KEY,</span><br><span class="line">    name VARCHAR(255) NOT NULL,</span><br><span class="line">    age INT</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 插入示例数据</span></span><br><span class="line">INSERT INTO userinfo (name, age) VALUES (<span class="string">&#x27;张三&#x27;</span>, 28), (<span class="string">&#x27;李四&#x27;</span>, 22), (<span class="string">&#x27;王五&#x27;</span>, 35);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看插入的数据</span></span><br><span class="line">SELECT * FROM userinfo;</span><br></pre></td></tr></table></figure>


  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/categories/">categories</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a target="_blank" rel="noopener" href="https://github.com/youngking-gfy">Projects</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%8C%96%E5%BA%94%E7%94%A8%EF%BC%88shell%EF%BC%89"><span class="toc-number">1.</span> <span class="toc-text">智能化应用（shell）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E5%88%9B%E5%BB%BA%E4%B8%BB%E7%9B%AE%E5%BD%95%E5%8F%8A%E5%90%84%E5%B1%82%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="toc-number">1.1.</span> <span class="toc-text">1.1 创建主目录及各层级目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-2-%E4%B8%BA%E7%9B%AE%E5%BD%95%E6%B7%BB%E5%8A%A0%E6%96%87%E4%BB%B6"><span class="toc-number">1.2.</span> <span class="toc-text">1.2 为目录添加文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-3-%E9%AA%8C%E8%AF%81%E7%9B%AE%E5%BD%95%E5%92%8C%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="toc-number">1.3.</span> <span class="toc-text">1.3 验证目录和文件结构</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E7%BC%96%E5%86%99%E8%84%9A%E6%9C%AC%E6%96%87%E4%BB%B6write-log-sh%EF%BC%8C%E7%94%A8%E4%BA%8E%E5%B0%86%E6%97%B6%E9%97%B4%E4%BF%A1%E6%81%AF%E5%86%99%E5%85%A5%E6%9C%8D%E5%8A%A1%E6%97%A5%E5%BF%97%E6%96%87%E4%BB%B6%EF%BC%88service-log%EF%BC%89%EF%BC%8C%E4%BF%9D%E5%AD%98%E8%B7%AF%E5%BE%84%E4%B8%BA-root-scripts-%E3%80%82"><span class="toc-number">1.4.</span> <span class="toc-text">2 编写脚本文件write_log.sh，用于将时间信息写入服务日志文件（service.log），保存路径为&#x2F;root&#x2F;scripts&#x2F;。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%B0%86%E4%BB%BB%E5%8A%A11%E4%B8%AD%E5%88%9B%E5%BB%BA%E7%9A%84%E9%A1%B9%E7%9B%AEsmart-police-system%E8%BF%9C%E7%A8%8B%E5%A4%8D%E5%88%B6%E8%87%B3%E4%B8%BB%E6%9C%BAjupyter%E5%AF%B9%E5%BA%94%E7%9A%84-root%E7%9B%AE%E5%BD%95%E4%B8%8B%E3%80%82"><span class="toc-number">1.5.</span> <span class="toc-text">3 将任务1中创建的项目smart-police-system远程复制至主机jupyter对应的 &#x2F;root目录下。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%B8%BA%E6%9B%B4%E5%A5%BD%E7%9B%91%E6%8E%A7%E6%9C%8D%E5%8A%A1%E7%8A%B6%E6%80%81%EF%BC%8C%E4%BD%BF%E7%94%A8cron%E6%9D%A5%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1%EF%BC%8C%E8%A6%81%E6%B1%82%E6%AF%8F%E4%BA%94%E5%88%86%E9%92%9F%E6%89%A7%E8%A1%8C%E4%B8%80%E6%AC%A1write-log-sh%E8%84%9A%E6%9C%AC%E3%80%82"><span class="toc-number">1.6.</span> <span class="toc-text">4. 为更好监控服务状态，使用cron来实现定时任务，要求每五分钟执行一次write_log.sh脚本。</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%AA%E5%88%86%E5%B8%83%E5%BC%8F%E9%9B%86%E7%BE%A4%E6%90%AD%E5%BB%BA"><span class="toc-number">2.</span> <span class="toc-text">伪分布式集群搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.</span> <span class="toc-text">基础配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%E4%B8%BA-qingjiao"><span class="toc-number">2.1.1.</span> <span class="toc-text">1. 修改主机名为 qingjiao</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6%E5%A4%B9-root-task"><span class="toc-number">2.1.2.</span> <span class="toc-text">2. 创建文件夹 &#x2F;root&#x2F;task</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%96%87%E4%BB%B6-root-task-student"><span class="toc-number">2.1.3.</span> <span class="toc-text">3. 创建文件 &#x2F;root&#x2F;task&#x2F;student</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E4%BF%AE%E6%94%B9-hosts-%E6%96%87%E4%BB%B6%E6%B7%BB%E5%8A%A0%E4%B8%BB%E6%9C%BA%E5%90%8D%E6%98%A0%E5%B0%84"><span class="toc-number">2.1.4.</span> <span class="toc-text">4. 修改 hosts 文件添加主机名映射</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BF%AE%E6%94%B9%E6%97%B6%E5%8C%BA%E4%B8%BA%E4%B8%8A%E6%B5%B7%E6%97%B6%E9%97%B4"><span class="toc-number">2.1.5.</span> <span class="toc-text">5. 修改时区为上海时间</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E6%B7%BB%E5%8A%A0%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="toc-number">2.1.6.</span> <span class="toc-text">6. 添加定时任务</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SSH%E5%85%8D%E5%AF%86%E9%85%8D%E7%BD%AE"><span class="toc-number">2.2.</span> <span class="toc-text">SSH免密配置</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E8%8A%82%E7%82%B9%E4%B8%AD%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%E6%96%87%E4%BB%B6id-rsa-pub-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8DRSA%EF%BC%8C%E7%94%A8%E6%88%B7root%EF%BC%8C%E4%B8%BB%E6%9C%BA%E5%90%8Dqingjiao"><span class="toc-number">2.2.1.</span> <span class="toc-text">1. 节点中生成公钥文件id_rsa.pub(数字签名RSA，用户root，主机名qingjiao)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%BB%BA%E2%BD%B4qingjiao%E2%BE%83%E8%BA%AB%E4%BD%BF%E2%BD%A4root%E2%BD%A4%E6%88%B7ssh%E8%AE%BF%E9%97%AElocalhost%E5%85%8D%E5%AF%86%E7%99%BB%E5%BD%95%EF%BC%88%E8%87%AA%E8%A1%8C%E5%AE%8C%E6%88%90%E9%A6%96%E6%AC%A1%E5%85%AC%E9%92%A5%E5%8C%99%E8%AE%A4%E8%AF%81%EF%BC%89"><span class="toc-number">2.2.2.</span> <span class="toc-text">2. 建⽴qingjiao⾃身使⽤root⽤户ssh访问localhost免密登录（自行完成首次公钥匙认证）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JDK%E5%AE%89%E8%A3%85"><span class="toc-number">2.3.</span> <span class="toc-text">JDK安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86jdk%E5%AE%89%E8%A3%85%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%88%B0-usr-java%E7%9B%AE%E5%BD%95%EF%BC%88%E5%AE%89%E8%A3%85%E5%8C%85%E5%AD%98%E6%94%BE%E4%BA%8E-usr-package277%EF%BC%8C%E8%B7%AF%E5%BE%84%E8%87%AA%E8%A1%8C%E5%88%9B%E5%BB%BA%EF%BC%8C%E8%A7%A3%E5%8E%8B%E5%90%8E%E6%96%87%E4%BB%B6%E5%A4%B9%E4%B8%BA%E9%BB%98%E8%AE%A4%E5%90%8D%E7%A7%B0%EF%BC%8C%E5%85%B6%E4%BB%96%E5%AE%89%E8%A3%85%E5%90%8C%E7%90%86%EF%BC%89"><span class="toc-number">2.3.1.</span> <span class="toc-text">1.将jdk安装包解压到&#x2F;usr&#x2F;java目录（安装包存放于&#x2F;usr&#x2F;package277，路径自行创建，解压后文件夹为默认名称，其他安装同理）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%B3%BB%E7%BB%9F%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FJAVA-HOME%EF%BC%8C%E5%90%8C%E6%97%B6%E5%B0%86JDK%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%E4%B8%ADbin%E7%9B%AE%E5%BD%95%E5%8A%A0%E5%85%A5PATH%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%8C%E6%B3%A8%E6%84%8F%E7%94%9F%E6%95%88%E5%8F%98%E9%87%8F%EF%BC%8C%E6%9F%A5%E7%9C%8BJDK%E7%89%88%E6%9C%AC"><span class="toc-number">2.4.</span> <span class="toc-text">2. 配置系统环境变量JAVA_HOME，同时将JDK安装路径中bin目录加入PATH系统变量，注意生效变量，查看JDK版本</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hadoo%E4%BC%AA%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2"><span class="toc-number">2.5.</span> <span class="toc-text">Hadoo伪集群部署</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%B0%86Hadoop%E5%AE%89%E8%A3%85%E5%8C%85%E8%A7%A3%E5%8E%8B%E5%88%B0%E6%8C%87%E5%AE%9A%E8%B7%AF%E5%BE%84-usr-hadoop%EF%BC%88%E5%AE%89%E8%A3%85%E5%8C%85%E5%AD%98%E6%94%BE%E4%BA%8E-usr-package277-%EF%BC%89"><span class="toc-number">2.5.1.</span> <span class="toc-text">1. 将Hadoop安装包解压到指定路径&#x2F;usr&#x2F;hadoop（安装包存放于&#x2F;usr&#x2F;package277&#x2F;）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8FHADOOP-HOME%EF%BC%8C%E5%B0%86Hadoop%E5%AE%89%E8%A3%85%E8%B7%AF%E5%BE%84%E4%B8%ADbin%E7%9B%AE%E5%BD%95%E5%92%8Csbin%E7%9B%AE%E5%BD%95%E5%8A%A0%E5%85%A5PATH%E7%B3%BB%E7%BB%9F%E5%8F%98%E9%87%8F%EF%BC%8C%E6%B3%A8%E6%84%8F%E7%94%9F%E6%95%88%E5%8F%98%E9%87%8F"><span class="toc-number">2.5.2.</span> <span class="toc-text">2. 配置环境变量HADOOP_HOME，将Hadoop安装路径中bin目录和sbin目录加入PATH系统变量，注意生效变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E9%85%8D%E7%BD%AEHadoop%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83JAVA-HOME-hadoop-env-sh"><span class="toc-number">2.5.3.</span> <span class="toc-text">3. 配置Hadoop运行环境JAVA_HOME(hadoop-env.sh)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9AHDFS%E4%B8%8ANameNode%E5%9C%B0%E5%9D%80%E4%B8%BAqingjiao-%E7%AB%AF%E5%8F%A3%E9%BB%98%E8%AE%A4%E4%B8%BA9000-core-site-xml"><span class="toc-number">2.5.4.</span> <span class="toc-text">4. 设置全局参数，指定HDFS上NameNode地址为qingjiao,端口默认为9000(core-site.xml)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E8%AE%BE%E7%BD%AE%E5%85%A8%E5%B1%80%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9A%E4%B8%B4%E6%97%B6%E5%AD%98%E5%82%A8%E7%9B%AE%E5%BD%95%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-tmp-%E8%A6%81%E6%B1%82%E4%B8%BA%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84%EF%BC%8C%E4%B8%8B%E5%90%8C"><span class="toc-number">2.5.5.</span> <span class="toc-text">5. 设置全局参数，指定临时存储目录为本地&#x2F;root&#x2F;hadoopData&#x2F;tmp(要求为绝对路径，下同)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9A%E5%A4%87%E4%BB%BD%E6%96%87%E6%9C%AC%E6%95%B0%E9%87%8F%E4%B8%BA1%EF%BC%88hdfs-site-xml%EF%BC%89"><span class="toc-number">2.5.6.</span> <span class="toc-text">6. 设置HDFS参数，指定备份文本数量为1（hdfs-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9ANN%E5%AD%98%E6%94%BE%E5%85%83%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%E8%B7%AF%E5%BE%84%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-name%EF%BC%9B%E6%8C%87%E5%AE%9ADN%E5%AD%98%E6%94%BE%E5%85%83%E6%95%B0%E6%8D%AE%E4%BF%A1%E6%81%AF%E8%B7%AF%E5%BE%84%E4%B8%BA%E6%9C%AC%E5%9C%B0-root-hadoopData-data-%E8%A6%81%E6%B1%82%E4%B8%BA%E7%BB%9D%E5%AF%B9%E8%B7%AF%E5%BE%84"><span class="toc-number">2.5.7.</span> <span class="toc-text">7. 设置HDFS参数，指定NN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;name；指定DN存放元数据信息路径为本地&#x2F;root&#x2F;hadoopData&#x2F;data(要求为绝对路径)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#8-%E8%AE%BE%E7%BD%AEHDFS%E5%8F%82%E6%95%B0%EF%BC%8C%E5%85%B3%E9%97%ADhadoop%E9%9B%86%E7%BE%A4%E6%9D%83%E9%99%90%E6%A0%A1%E9%AA%8C%EF%BC%88%E5%AE%89%E5%85%A8%E9%85%8D%E7%BD%AE%EF%BC%89%EF%BC%8C%E5%85%81%E8%AE%B8%E5%85%B6%E4%BB%96%E7%94%A8%E6%88%B7%E8%BF%9E%E6%8E%A5%E9%9B%86%E7%BE%A4"><span class="toc-number">2.5.8.</span> <span class="toc-text">8. 设置HDFS参数，关闭hadoop集群权限校验（安全配置），允许其他用户连接集群</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#9-%E8%AE%BE%E7%BD%AEYARN%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83-JAVA-HOME%E5%8F%82%E6%95%B0-yarn-env-sh"><span class="toc-number">2.5.9.</span> <span class="toc-text">9. 设置YARN运行环境$JAVA_HOME参数(yarn-env.sh)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#10-%E8%AE%BE%E7%BD%AEYARN%E6%A0%B8%E5%BF%83%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9Amapreduce-%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E5%BC%8F%E4%B8%BAmapreduce-shuffle%EF%BC%88yarn-site-xml%EF%BC%89"><span class="toc-number">2.5.10.</span> <span class="toc-text">10. 设置YARN核心参数，指定mapreduce 获取数据的方式为mapreduce_shuffle（yarn-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#11-%E8%AE%BE%E7%BD%AE%E8%AE%A1%E7%AE%97%E6%A1%86%E6%9E%B6%E5%8F%82%E6%95%B0%EF%BC%8C%E6%8C%87%E5%AE%9AMR%E8%BF%90%E8%A1%8C%E5%9C%A8yarn%E4%B8%8A%EF%BC%88mapred-site-xml%EF%BC%89"><span class="toc-number">2.5.11.</span> <span class="toc-text">11. 设置计算框架参数，指定MR运行在yarn上（mapred-site.xml）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#12-%E8%AE%BE%E7%BD%AE%E8%8A%82%E7%82%B9%E6%96%87%E4%BB%B6slaves%EF%BC%8C%E8%A6%81%E6%B1%82qingjiao%E4%B8%BA%E5%AD%90%E8%8A%82%E7%82%B9"><span class="toc-number">2.5.12.</span> <span class="toc-text">12. 设置节点文件slaves，要求qingjiao为子节点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#13-%E5%AF%B9%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BF%9B%E8%A1%8C%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-number">2.5.13.</span> <span class="toc-text">13. 对文件系统进行格式化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#14-%E5%90%AF%E5%8A%A8Hadoop%E9%9B%86%E7%BE%A4%E6%9F%A5%E7%9C%8B%E5%90%84%E8%8A%82%E7%82%B9%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.5.14.</span> <span class="toc-text">14. 启动Hadoop集群查看各节点服务</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#15-%E6%9F%A5%E7%9C%8B%E9%9B%86%E7%BE%A4%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8"><span class="toc-number">2.5.15.</span> <span class="toc-text">15. 查看集群运行状态是否正常</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E9%80%9A%E4%BA%8B%E6%95%85%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="toc-number">3.</span> <span class="toc-text">交通事故数据分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%B5%E4%BF%A1%E8%AF%88%E9%AA%97%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%EF%BC%88Python%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">电信诈骗数据分析（Python）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%83%8C%E6%99%AF%E8%AF%B4%E6%98%8E"><span class="toc-number">4.0.1.</span> <span class="toc-text">背景说明</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%8E%A2%E7%B4%A2%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number"></span> <span class="toc-text">一、探索性分析</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%95%B4%E4%BD%93%E7%89%B9%E5%BE%81%E5%88%86%E6%9E%90%EF%BC%8C%E8%A7%82%E5%AF%9F%E7%89%B9%E5%BE%81%E4%B9%8B%E9%97%B4%E7%9A%84%E7%9B%B8%E5%85%B3%E6%80%A7"><span class="toc-number"></span> <span class="toc-text">二、整体特征分析，观察特征之间的相关性</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%86%E7%BB%84%E8%81%9A%E5%90%88%E5%88%86%E6%9E%90"><span class="toc-number"></span> <span class="toc-text">三、分组聚合分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BB%BB%E5%8A%A1%E4%B8%80%EF%BC%9A%E5%88%86%E6%9E%90-distance-from-home%E4%B8%8Efraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">1.</span> <span class="toc-text">3.2 任务一：分析 distance_from_home与fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-2-%E4%BB%BB%E5%8A%A1%E4%BA%8C%EF%BC%9A%E5%88%86%E6%9E%90-ratio-to-median-purchase-price%E4%B8%8E-fraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">2.</span> <span class="toc-text">3.2 任务二：分析 ratio_to_median_purchase_price与 fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-3-%E4%BB%BB%E5%8A%A1%E4%B8%89%EF%BC%9A%E5%88%86%E6%9E%90-repeat-retailer%E4%B8%8E-fraud%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">3.</span> <span class="toc-text">3.3 任务三：分析 repeat_retailer与 fraud之间的关系</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mysql"><span class="toc-number">4.</span> <span class="toc-text">Mysql</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%BC%80%E5%90%AF-MySQL-%E6%9C%8D%E5%8A%A1"><span class="toc-number">4.1.</span> <span class="toc-text">1. 开启 MySQL 服务</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93-relation"><span class="toc-number">4.2.</span> <span class="toc-text">2. 创建数据库 relation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8-user-%E5%B9%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">4.3.</span> <span class="toc-text">3. 创建数据表 user 并导入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8-friend-%E5%B9%B6%E5%AF%BC%E5%85%A5%E6%95%B0%E6%8D%AE"><span class="toc-number">4.4.</span> <span class="toc-text">4. 创建数据表 friend 并导入数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%88%86%E6%9E%90%E4%B8%8D%E5%90%8C%E7%94%A8%E6%88%B7%E7%9A%84%E5%A5%BD%E5%8F%8B%E6%95%B0%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table1"><span class="toc-number">4.5.</span> <span class="toc-text">5. 分析不同用户的好友数并存储为视图 table1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%9F%A5%E6%89%BE%E7%94%A8%E6%88%B7%E2%80%9C%E7%B3%BB%E4%B9%90%E2%80%9D%E7%9A%84%E6%89%80%E6%9C%89%E6%9C%8B%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table2"><span class="toc-number">4.6.</span> <span class="toc-text">6. 查找用户“系乐”的所有朋友信息并存储为视图 table2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E6%9F%A5%E8%AF%A2%E7%94%A8%E6%88%B7%E7%9A%84%E6%89%80%E6%9C%89%E5%A5%BD%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table3"><span class="toc-number">4.7.</span> <span class="toc-text">7. 查询用户的所有好友信息并存储为视图 table3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-%E6%9F%A5%E8%AF%A2%E2%80%9C%E7%B3%BB%E4%B9%90%E2%80%9D%E5%92%8C%E2%80%9C%E5%A7%9A%E6%AC%A3%E7%84%B6%E2%80%9D%E7%9A%84%E5%85%B1%E5%90%8C%E5%A5%BD%E5%8F%8B%E4%BF%A1%E6%81%AF%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table4"><span class="toc-number">4.8.</span> <span class="toc-text">8. 查询“系乐”和“姚欣然”的共同好友信息并存储为视图 table4</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-%E8%BF%9B%E8%A1%8C%E7%A4%BE%E4%BA%A4%E7%BD%91%E7%BB%9C%E6%8C%96%E6%8E%98%E5%B9%B6%E5%AD%98%E5%82%A8%E4%B8%BA%E8%A7%86%E5%9B%BE-table5"><span class="toc-number">4.9.</span> <span class="toc-text">9. 进行社交网络挖掘并存储为视图 table5</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%89%E5%85%A8%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">数据库安全管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%90%AF%E5%8A%A8-MySQL-%E6%9C%8D%E5%8A%A1%E5%B9%B6%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E7%8A%B6%E6%80%81"><span class="toc-number">5.1.</span> <span class="toc-text">1. 启动 MySQL 服务并查看服务状态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7-qingjiao"><span class="toc-number">5.2.</span> <span class="toc-text">2. 创建用户 qingjiao</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%8E%88%E4%BA%88-qingjiao-%E7%94%A8%E6%88%B7%E5%9C%A8-datatest-%E5%BA%93%E4%B8%8B%E7%9A%84-CREATE-%E6%9D%83%E9%99%90"><span class="toc-number">5.3.</span> <span class="toc-text">3. 授予 qingjiao 用户在 datatest 库下的 CREATE 权限</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%88%87%E6%8D%A2%E5%88%B0-qingjiao-%E7%94%A8%E6%88%B7%E5%B9%B6%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E5%BA%93%E5%92%8C%E8%A1%A8"><span class="toc-number">5.4.</span> <span class="toc-text">4. 切换到 qingjiao 用户并创建数据库和表</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://youngking-gfy.github.io/article/dy1fras1/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://youngking-gfy.github.io/article/dy1fras1/&text=大数据模拟赛题解"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://youngking-gfy.github.io/article/dy1fras1/&is_video=false&description=大数据模拟赛题解"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=大数据模拟赛题解&body=Check out this article: https://youngking-gfy.github.io/article/dy1fras1/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://youngking-gfy.github.io/article/dy1fras1/&title=大数据模拟赛题解"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://youngking-gfy.github.io/article/dy1fras1/&name=大数据模拟赛题解&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://youngking-gfy.github.io/article/dy1fras1/&t=大数据模拟赛题解"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2025
    Y0ungK1ng
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">categories</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a target="_blank" rel="noopener" href="https://github.com/youngking-gfy">Projects</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
